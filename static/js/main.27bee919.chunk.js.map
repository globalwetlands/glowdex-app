{"version":3,"sources":["common/Spinner.module.css","app/App.module.css","common/SliderInput.module.css","common/Spinner.js","redux/gridItemsSlice.js","utils/mapUtils.js","features/map/mapStyles.js","features/map/Map.js","utils/utils.js","utils/colorUtils.js","utils/dataUtils.js","utils/dataHooks.js","common/SliderInput.js","redux/globalSettingsSlice.js","features/widgets/charts/TypologyBoxPlot.js","features/widgets/GridItemWidget.js","features/widgets/MapLegend.js","common/IconButton.js","common/Popup.js","images/fig1.png","features/widgets/Menu.js","features/widgets/WidgetBox.js","features/widgets/Widgets.js","app/App.js","redux/store.js","index.js"],"names":["module","exports","Spinner","isSmall","props","size","className","styles","spinner","width","height","viewBox","xmlns","pathSmall","path","fill","strokeWidth","strokeLinecap","cx","cy","r","gridItemsSlice","createSlice","name","initialState","selectedGridItems","reducers","setSelectedGridItems","state","action","payload","actions","getBboxCenter","minLng","minLat","maxLng","maxLat","latitude","longitude","formatCoordinate","formatcoords","format","decimalPlaces","gridLayerStyle","id","type","paint","gridLayerHoverStyle","gridLayerSelectedStyle","Map","mapFeatures","gridItems","clusters","isLoading","mapRef","useRef","dispatch","useDispatch","useSelector","viewport","setViewport","useState","zoom","minZoom","hoveredFeature","setHoveredFeature","fitBounds","useCallback","async","feature","duration","bbox","updatedViewport","transitionDuration","transitionInterpolator","FlyToInterpolator","ms","Promise","resolve","setTimeout","delay","hoveredFeatureFilter","useMemo","properties","ID","selectedFeatureFilter","mapStyle","onViewportChange","mapboxApiAccessToken","process","onHover","e","features","srcEvent","offsetX","offsetY","find","f","layer","x","y","onMouseOut","onClick","clickedFeature","ref","getCursor","isHovering","isDragging","data","filter","clusterNumber","gridItem","item","parseInt","cluster","n","style","left","top","TERRITORY1","backgroundColor","fillColor","border","color","fontWeight","renderTooltip","position","getBrewerColors","scaleName","alpha","scale","chroma","brewer","map","css","opacify","fetcher","args","fetch","then","res","json","fetcherCsv","text","csvString","Papa","parse","header","dynamicTyping","parseCsv","indicatorColnames","_","chain","indicatorLabels","indicatorRow","habitatLabel","habitatColor","habitat","sortBy","keyBy","value","indicatorColnamesKeys","Object","keys","useMapData","numberOfClusters","globalSettings","gridGeojson","useSWR","allClusters","gridItemData","gridItemResidualsData","residuals","colors","fillColors","range","length","generateClusters","clusterItems","console","time","groupedByClusterN","groupBy","Cluster","nclust","getClusterItems","timeEnd","isEmpty","matchingClusterItem","generateMapFeatures","clusterNumbers","generateGridLayerStyle","gridItemsPerCluster","SliderInput","onChange","debounceMs","val","setVal","useDebounce","showMenuHelpText","typologyBoxPlotQuantile","enabledHabitats","globalSettingsSlice","hideMenuHelpText","setNumberOfClusters","setTypologyBoxPlotQuantile","toggleEnabledHabitat","includes","xor","Plot","createPlotlyComponent","Plotly","config","displayModeBar","layout","plot_bgcolor","paper_bgcolor","showlegend","legend","hovermode","margin","l","t","b","xaxis","showticklabels","zeroline","mirror","tickmode","yaxis","tickfont","boxgap","getColumnDisplayName","colName","label","toLowerCase","selectedCellMarker","symbol","line","useTypologyPlotData","significantIndicatorColumns","filteredColumns","getColumnHabitat","columnsByDimension","columns","col","dimension","groupedPlots","indicatorColumns","boxplots","reverse","getColumnColor","marker","currentGridItemMarkers","displayName","currentGridItemLegendTrace","TypologyBoxPlot","quantileValue","containerRef","useMeasure","columnSignificance","accessor","upper","quantile","lower","Math","sign","index","significanceFactor","filterSignificantData","GridItemWidget","selectedGridItemData","centerCoords","TypologyBoxPlotQuantileInput","maxWidth","marginBottom","min","max","step","MapLegend","HabitatCheckbox","title","target","checked","borderColor","IconButton","Icon","role","onKeyDown","code","tabIndex","Popup","modalIsOpen","setModalIsOpen","children","closeModal","isOpen","onAfterOpen","onRequestClose","overlayClassName","CloseIcon","Modal","setAppElement","MenuPopupContent","src","fig1","alt","MenuIcon","stroke","strokeLinejoin","d","x1","y1","x2","y2","Menu","menuIsOpen","setMenuIsOpen","WidgetBox","onClose","Widgets","selectedID","mapFeature","useSelectedGridItemData","initialPanelSizes","App","main","direction","SplitDirection","Horizontal","initialSizes","minWidth","gutterClassName","ReactSplitGutterHorizontal","draggerClassName","ReactSplitDraggerHorizontal","rootReducer","combineReducers","key","reducer","persistConfig","storage","persistReducer","createPersistedReducer","store","configureStore","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","FLUSH","REHYDRATE","PAUSE","PERSIST","PURGE","REGISTER","persistor","persistStore","ReactDOM","render","StrictMode","loading","document","getElementById"],"mappings":"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","file":"static/js/main.27bee919.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"spinner\":\"Spinner_spinner__1QSjx\",\"rotator\":\"Spinner_rotator__ldWJL\",\"path\":\"Spinner_path__B6xE1\",\"dash\":\"Spinner_dash__3VCIb\",\"colors\":\"Spinner_colors__3EM4d\",\"pathSmall\":\"Spinner_pathSmall__1zioJ\",\"dashSmall\":\"Spinner_dashSmall__2ti9Z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"App_main__3cTDB\",\"ReactSplitGutterHorizontal\":\"App_ReactSplitGutterHorizontal__15IR8\",\"ReactSplitDraggerHorizontal\":\"App_ReactSplitDraggerHorizontal__2flWb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"SliderInput\":\"SliderInput_SliderInput__2uRuk\"};","import styles from './Spinner.module.css'\n\nexport function Spinner({ isSmall = false, ...props }) {\n  const size = isSmall ? 25 : 66\n  return (\n    <svg\n      className={styles.spinner}\n      data-testid=\"spinner\"\n      width={size}\n      height={size}\n      viewBox={`0 0 ${size} ${size}`}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      {...props}\n    >\n      <circle\n        className={isSmall ? styles.pathSmall : styles.path}\n        fill=\"none\"\n        strokeWidth={size / 10}\n        strokeLinecap=\"round\"\n        cx={size / 2}\n        cy={size / 2}\n        r={size / 2 - 3}\n      />\n    </svg>\n  )\n}\n","import { createSlice } from '@reduxjs/toolkit'\n\nconst initialState = {\n  selectedGridItems: [],\n}\n\nconst gridItemsSlice = createSlice({\n  name: 'gridItems',\n  initialState,\n  reducers: {\n    setSelectedGridItems: (state, action) => {\n      state.selectedGridItems = action.payload\n    },\n  },\n})\n\nexport const { setSelectedGridItems } = gridItemsSlice.actions\n\nexport default gridItemsSlice.reducer\n","import formatcoords from 'formatcoords'\n\nexport function getBboxCenter({ minLng, minLat, maxLng, maxLat }) {\n  const centerLat = (minLat + maxLat) / 2\n  const centerLng = (minLng + maxLng) / 2\n  return { latitude: centerLat, longitude: centerLng }\n}\n\nexport function formatCoordinate({ latitude, longitude }) {\n  return formatcoords(latitude, longitude).format('FFf', { decimalPlaces: 1 })\n}\n","export const gridLayerStyle = {\n  id: 'gridItems',\n  type: 'fill',\n  paint: {\n    'fill-opacity': 1,\n    'fill-outline-color': ['get', 'color'],\n    'fill-color': ['get', 'fillColor'],\n  },\n}\n\nexport const gridLayerHoverStyle = {\n  id: 'gridItemsHighlighted',\n  type: 'fill',\n  paint: {\n    'fill-opacity': 1,\n    'fill-outline-color': ['get', 'color'],\n    'fill-color': ['get', 'color'],\n  },\n}\n\nexport const gridLayerSelectedStyle = {\n  id: 'gridItemsSelected',\n  type: 'fill',\n  paint: {\n    'fill-opacity': 1,\n    'fill-outline-color': ['get', 'color'],\n    'fill-color': ['get', 'color'],\n  },\n}\n","import './Map.css'\n\nimport { useCallback, useMemo, useRef, useState } from 'react'\nimport {\n  FlyToInterpolator,\n  Layer,\n  InteractiveMap as MapGL,\n  NavigationControl,\n  Source,\n} from 'react-map-gl'\nimport { useDispatch, useSelector } from 'react-redux'\n\nimport bbox from '@turf/bbox'\n\nimport { Spinner } from '../../common/Spinner'\nimport { setSelectedGridItems } from '../../redux/gridItemsSlice'\nimport { getBboxCenter } from '../../utils/mapUtils'\nimport { delay } from '../../utils/utils'\nimport {\n  gridLayerHoverStyle,\n  gridLayerSelectedStyle,\n  gridLayerStyle,\n} from './mapStyles'\n\nexport function Map({ mapFeatures, gridItems, clusters, isLoading }) {\n  const mapboxApiAccessToken = process.env.REACT_APP_MAPBOX_ACCESS_TOKEN\n  const mapStyle =\n    'mapbox://styles/ejinks-gu/ckhycntp61ol31am7qum156sk?optimize=true'\n  const mapRef = useRef()\n\n  const dispatch = useDispatch()\n  const selectedGridItems = useSelector(\n    (state) => state.gridItems.selectedGridItems\n  )\n\n  const [viewport, setViewport] = useState({\n    // width: 400,\n    // height: 400,\n    latitude: 20,\n    longitude: 0,\n    zoom: 2,\n    minZoom: 2,\n  })\n\n  const [hoveredFeature, setHoveredFeature] = useState({})\n\n  const fitBounds = useCallback(\n    async (feature, duration = 250) => {\n      // calculate the bounding box of the feature\n      const [minLng, minLat, maxLng, maxLat] = bbox(feature)\n      const { longitude, latitude } = getBboxCenter({\n        minLng,\n        minLat,\n        maxLng,\n        maxLat,\n      })\n\n      const zoom = 5\n\n      const updatedViewport = {\n        ...viewport,\n        longitude,\n        latitude,\n        zoom,\n        transitionDuration: duration,\n        transitionInterpolator: new FlyToInterpolator(),\n        // transitionEasing: d3.easeCubic,\n      }\n      setViewport(updatedViewport)\n      await delay(duration + 50)\n      return\n    },\n    [viewport]\n  )\n\n  const onHover = (e) => {\n    const {\n      features,\n      srcEvent: { offsetX, offsetY },\n    } = e\n    const hoveredFeature =\n      features && features.find((f) => f.layer.id === gridLayerStyle.id)\n\n    setHoveredFeature({\n      feature: hoveredFeature,\n      x: offsetX,\n      y: offsetY,\n    })\n  }\n\n  const onMouseOut = () => {\n    setHoveredFeature({})\n  }\n\n  const onClick = async (e) => {\n    const { features } = e\n    const clickedFeature =\n      features && features.find((f) => f.layer.id === gridLayerStyle.id)\n    if (clickedFeature) {\n      const { ID } = clickedFeature.properties\n      await fitBounds(clickedFeature)\n      dispatch(setSelectedGridItems([ID]))\n    }\n  }\n\n  const renderTooltip = () => {\n    const { feature, x, y } = hoveredFeature\n\n    if (!feature) {\n      return null\n    }\n\n    const id = feature.properties?.ID\n    const clusterNumber = feature.properties?.clusterNumber\n\n    const gridItem = gridItems.find((item) => parseInt(item.ID) === id)\n\n    const cluster = clusters.find(({ n }) => n === clusterNumber)\n\n    return (\n      feature && (\n        <div className=\"Map--Tooltip\" style={{ left: x, top: y }}>\n          <div className=\"control\">\n            <div className=\"tags has-addons\">\n              <span className=\"tag\">ID</span>\n              <span className=\"tag has-text-weight-bold\">{gridItem?.ID}</span>\n            </div>\n          </div>\n\n          <div className=\"control\">\n            <div className=\"tags has-addons\">\n              <span className=\"tag\">Country</span>\n              <span className=\"tag has-text-weight-bold\">\n                {gridItem?.TERRITORY1}\n              </span>\n            </div>\n          </div>\n\n          <div className=\"control\">\n            <div className=\"tags has-addons\">\n              <span className=\"tag\">Typology</span>\n              <span\n                className=\"tag\"\n                style={{\n                  backgroundColor: cluster.fillColor,\n                  border: `1px solid ${cluster.color}`,\n                  fontWeight: 600,\n                }}\n              >\n                {clusterNumber}\n              </span>\n            </div>\n          </div>\n        </div>\n      )\n    )\n  }\n\n  const getCursor = (e) => {\n    if (e.isHovering) {\n      return 'pointer'\n    }\n    if (e?.isDragging) {\n      return 'grabbing'\n    }\n    if (hoveredFeature?.feature) {\n      return 'crosshair'\n    }\n    return 'grab'\n  }\n\n  const hoveredFeatureFilter = useMemo(() => {\n    // A filter that matches the hovered feature by ID\n    return ['==', 'ID', hoveredFeature?.feature?.properties?.ID || false]\n  }, [hoveredFeature])\n\n  const selectedFeatureFilter = useMemo(() => {\n    // A filter that matches the selected features by ID\n    return ['in', ['get', 'ID'], ['literal', selectedGridItems]]\n  }, [selectedGridItems])\n\n  return (\n    <div className=\"Map\" data-testid=\"Map\">\n      <MapGL\n        {...viewport}\n        width=\"100%\"\n        height=\"100%\"\n        mapStyle={mapStyle}\n        onViewportChange={setViewport}\n        mapboxApiAccessToken={mapboxApiAccessToken}\n        onHover={onHover}\n        onMouseOut={onMouseOut}\n        onClick={onClick}\n        ref={mapRef}\n        getCursor={getCursor}\n      >\n        <NavigationControl\n          className=\"Map--NavigationControl\"\n          onViewportChange={setViewport}\n        />\n\n        {!isLoading && (\n          <Source\n            type=\"geojson\"\n            data={{ type: 'FeatureCollection', features: mapFeatures }}\n          >\n            <Layer {...gridLayerStyle} />\n            <Layer {...gridLayerHoverStyle} filter={hoveredFeatureFilter} />\n            <Layer {...gridLayerSelectedStyle} filter={selectedFeatureFilter} />\n          </Source>\n        )}\n\n        {renderTooltip()}\n      </MapGL>\n\n      {isLoading && (\n        <Spinner\n          style={{\n            position: 'absolute',\n            top: 'calc(50% - 33px)',\n            left: 'calc(50% - 33px)',\n          }}\n        />\n      )}\n    </div>\n  )\n}\n","export async function delay(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms))\n}\n","import chroma from 'chroma-js'\n\nexport function getBrewerColors({ scaleName = 'Set2', alpha = 1 } = {}) {\n  let scale = chroma.brewer?.[scaleName]\n\n  if (alpha < 1) {\n    scale = scale.map((color) => opacify({ color, alpha }))\n  }\n\n  return scale\n}\n\nexport function opacify({ color, alpha }) {\n  return chroma(color).alpha(alpha).css()\n}\n","import _ from 'lodash'\nimport Papa from 'papaparse'\n\nimport indicatorLabels from './indicator-labels.json'\n\nexport const fetcher = (...args) => fetch(...args).then((res) => res.json())\nexport const fetcherCsv = (...args) =>\n  fetch(...args)\n    .then((res) => res.text())\n    .then((csvString) => parseCsv({ csvString }))\n\nexport const loadGeojson = async ({\n  name = 'grid', // country, aoi, wdpa\n}) => {\n  const dataUrl = `${process.env.PUBLIC_URL}/geojson/${name}.json`\n  console.log('Loading geojson data', dataUrl)\n  // await delay(1000)\n  const data = await fetch(dataUrl).then((res) => res.json())\n  return data\n}\n\nexport const loadSingleLocationData = async (locationID) => {\n  console.log(`Loading location ${locationID} data`)\n  const dataUrl = `${process.env.PUBLIC_URL}/locations_data/${locationID}.json`\n  const data = fetch(dataUrl).then((res) => res.json())\n  // await delay(1000)\n  return data\n}\n\nexport async function parseCsv({ csvString }) {\n  const { data } = Papa.parse(csvString, { header: true, dynamicTyping: true })\n  return data\n}\n\nfunction mapHabitatData(indicatorRow) {\n  let habitatLabel = ''\n  let habitatColor = ''\n  switch (indicatorRow.habitat) {\n    // #ff5500\n    // #00aacc\n    case 'mg':\n      habitatLabel = 'Mangrove'\n      habitatColor = 'hsla(0, 66%, 63%, 1)'\n      break\n\n    case 'sg':\n      habitatLabel = 'Seagrass'\n      habitatColor = 'hsla(83, 53%, 59%, 1)'\n      break\n\n    case 'sm':\n      habitatLabel = 'Saltmarsh'\n      habitatColor = 'hsla(161, 53%, 58%, 1)'\n      break\n\n    default:\n      habitatLabel = ''\n  }\n  return { ...indicatorRow, habitatLabel, habitatColor }\n}\n\nexport const indicatorColnames = _.chain(indicatorLabels)\n  .map(mapHabitatData)\n  .sortBy(['habitat', 'indicator'])\n  .keyBy('indicator')\n  .value()\n\nexport const indicatorColnamesKeys = Object.keys(indicatorColnames)\n","import _ from 'lodash'\nimport { useMemo } from 'react'\nimport { useSelector } from 'react-redux'\nimport useSWR from 'swr'\n\nimport bbox from '@turf/bbox'\n\nimport { getBrewerColors } from './colorUtils'\nimport { fetcher, fetcherCsv } from './dataUtils'\nimport { getBboxCenter } from './mapUtils'\n\nexport function generateGridLayerStyle({ clusters }) {\n  const colors = clusters.map((cluster) => cluster.color)\n  const fillColors = clusters.map((cluster) => cluster.fillColor)\n  const clusterNumbers = clusters.map((cluster) => cluster.n)\n  return {\n    id: `gridItems`,\n    type: 'fill',\n    paint: {\n      'fill-opacity': 1,\n      // TODO: Add hover state\n      'fill-outline-color': [\n        'to-color',\n        [\n          'at',\n          ['index-of', ['get', 'clusterNumber'], ['literal', clusterNumbers]],\n          ['literal', colors],\n        ],\n      ],\n      'fill-color': [\n        'to-color',\n        [\n          'at',\n          ['index-of', ['get', 'clusterNumber'], ['literal', clusterNumbers]],\n          ['literal', fillColors],\n        ],\n      ],\n    },\n  }\n}\n\nfunction getClusterItems({ numberOfClusters, allClusters }) {\n  // change cluster data types to Integers\n  const groupedByClusterN = _.groupBy(allClusters, 'nclust')\n  const clusterItems = groupedByClusterN?.[numberOfClusters]?.map(\n    ({ ID, Cluster, nclust }) => ({\n      ID: parseInt(ID),\n      cluster: parseInt(Cluster),\n      nclust: parseInt(nclust),\n    })\n  )\n\n  const clusterItemsObj = _.keyBy(clusterItems, 'ID')\n\n  return clusterItemsObj\n}\n\nfunction generateMapFeatures({ mapFeatures, clusterItems, clusters }) {\n  function addFeatureProps(feature) {\n    // Add cluster item props to feature\n    const matchingClusterItem = clusterItems?.[feature.properties.ID]\n    const cluster = clusters.find(({ n }) => n === matchingClusterItem?.cluster)\n\n    const { color, fillColor, n } = cluster\n\n    return {\n      ...feature,\n      properties: {\n        ...feature.properties,\n        clusterNumber: n,\n        color,\n        fillColor,\n        value: n,\n      },\n    }\n  }\n\n  return mapFeatures.map(addFeatureProps)\n}\n\nfunction generateClusters({ numberOfClusters }) {\n  const colors = getBrewerColors()\n  const fillColors = getBrewerColors({ alpha: 0.4 })\n\n  const clusters = _.range(1, numberOfClusters + 1).map((n) => {\n    const color = colors[(n - 1) % colors.length]\n    const fillColor = fillColors[(n - 1) % colors.length]\n    return { n, color, fillColor }\n  })\n\n  return clusters\n}\n\nexport function useMapData() {\n  const numberOfClusters = useSelector(\n    (state) => state.globalSettings.numberOfClusters\n  )\n  const { data: gridGeojson } = useSWR(\n    `${process.env.PUBLIC_URL}/data/grid.geojson`,\n    fetcher\n  )\n  const { data: allClusters } = useSWR(\n    `${process.env.PUBLIC_URL}/data/all-clusters.csv`,\n    fetcherCsv\n  )\n  const { data: gridItemData } = useSWR(\n    `${process.env.PUBLIC_URL}/data/grid-items.csv`,\n    fetcherCsv\n  )\n  const { data: gridItemResidualsData } = useSWR(\n    `${process.env.PUBLIC_URL}/data/grid-items-residuals.csv`,\n    fetcherCsv\n  )\n\n  const gridItems = useMemo(() => {\n    if (gridItemData && gridItemResidualsData) {\n      return gridItemData.map((gridItem) => {\n        const residuals = gridItemResidualsData.find(\n          ({ ID }) => ID === gridItem.ID\n        )\n        return {\n          ...gridItem,\n          residuals,\n        }\n      })\n    } else {\n      return []\n    }\n  }, [gridItemData, gridItemResidualsData])\n\n  const isLoading = useMemo(\n    () => !gridGeojson || !allClusters,\n    [allClusters, gridGeojson]\n  )\n\n  const clusters = useMemo(\n    () => generateClusters({ numberOfClusters }),\n    [numberOfClusters]\n  )\n\n  const clusterItems = useMemo(() => {\n    if (allClusters?.length) {\n      console.time('getClusterItems')\n      const clusterItems = getClusterItems({\n        numberOfClusters,\n        allClusters,\n      })\n      console.timeEnd('getClusterItems')\n      return clusterItems\n    }\n  }, [allClusters, numberOfClusters])\n\n  const mapFeatures = useMemo(() => {\n    if (gridGeojson?.features && !_.isEmpty(clusterItems)) {\n      console.time('generateMapFeatures')\n\n      const mapFeatures = generateMapFeatures({\n        clusterItems,\n        clusters,\n        mapFeatures: gridGeojson?.features,\n      })\n\n      console.timeEnd('generateMapFeatures')\n      return mapFeatures\n    } else {\n      return []\n    }\n  }, [clusterItems, clusters, gridGeojson?.features])\n\n  const gridLayerStyle = useMemo(() => {\n    const gridLayerStyle = generateGridLayerStyle({\n      clusters,\n    })\n    return gridLayerStyle\n  }, [clusters])\n\n  const gridItemsPerCluster = useMemo(() => {\n    if (gridItems && clusterItems) {\n      console.time('gridItemsPerCluster')\n      const gridItemsPerCluster = _.groupBy(gridItems, ({ ID }) => {\n        return clusterItems?.[parseInt(ID)]?.cluster\n      })\n      console.timeEnd('gridItemsPerCluster')\n      return gridItemsPerCluster\n    } else {\n      return undefined\n    }\n  }, [clusterItems, gridItems])\n\n  return {\n    mapFeatures,\n    allClusters,\n    clusters,\n    clusterItems,\n    gridItems,\n    isLoading,\n    gridLayerStyle,\n    gridItemsPerCluster,\n  }\n}\n\nexport function useSelectedGridItemData({ gridItems, mapFeatures }) {\n  // Returns the selected grid item data\n\n  const selectedGridItems = useSelector(\n    (state) => state.gridItems.selectedGridItems\n  )\n\n  const selectedGridItemData = useMemo(() => {\n    if (selectedGridItems?.length && gridItems?.length) {\n      // for each selected ID, get the data for that ID\n      const selectedGridItemsData = selectedGridItems.map((selectedID) => {\n        // Find grid item data by ID\n        const gridItem = gridItems.find(({ ID }) => selectedID === parseInt(ID))\n        // Find map feature props by ID\n        const mapFeature =\n          mapFeatures.find((feature) => feature.properties.ID === selectedID) ||\n          {}\n        const [minLng, minLat, maxLng, maxLat] = bbox(mapFeature)\n        const centerCoords = getBboxCenter({ minLng, minLat, maxLng, maxLat })\n        const featureProps = mapFeature?.properties || {}\n\n        return { ...gridItem, ...featureProps, centerCoords }\n      })\n      return selectedGridItemsData\n    } else {\n      return []\n    }\n  }, [selectedGridItems, gridItems, mapFeatures])\n  return { selectedGridItemData }\n}\n","import '@reach/slider/styles.css'\n\nimport { useState } from 'react'\nimport { useDebounce } from 'react-use'\n\nimport Slider from '@reach/slider'\n\nimport styles from './SliderInput.module.css'\n\nexport function SliderInput({ value, onChange, debounceMs = 0, ...props }) {\n  const [val, setVal] = useState(value)\n\n  // Debounce onChange handler\n  useDebounce(\n    () => {\n      onChange(val)\n    },\n    debounceMs,\n    [val]\n  )\n\n  return (\n    <Slider\n      className={styles.SliderInput}\n      value={val}\n      onChange={(value) => setVal(value)}\n      {...props}\n    />\n  )\n}\n","import _ from 'lodash'\n\nimport { createSlice } from '@reduxjs/toolkit'\n\nconst initialState = {\n  showMenuHelpText: true,\n  numberOfClusters: 5,\n  typologyBoxPlotQuantile: 0.8,\n  enabledHabitats: ['mg', 'sm', 'sg'],\n}\n\nconst globalSettingsSlice = createSlice({\n  name: 'globalSettings',\n  initialState,\n  reducers: {\n    hideMenuHelpText: (state) => {\n      state.showMenuHelpText = false\n    },\n    setNumberOfClusters: (state, action) => {\n      state.numberOfClusters = action.payload\n    },\n    setTypologyBoxPlotQuantile: (state, action) => {\n      state.typologyBoxPlotQuantile = action.payload\n    },\n    toggleEnabledHabitat: (state, action) => {\n      const habitat = action.payload\n\n      if (initialState.enabledHabitats.includes(habitat)) {\n        state.enabledHabitats = _.xor(state.enabledHabitats, [habitat])\n      }\n    },\n  },\n})\n\nexport const {\n  hideMenuHelpText,\n  setNumberOfClusters,\n  setTypologyBoxPlotQuantile,\n  toggleEnabledHabitat,\n} = globalSettingsSlice.actions\n\nexport default globalSettingsSlice.reducer\n","import { quantile } from 'd3-array'\nimport _ from 'lodash'\nimport Plotly from 'plotly.js-cartesian-dist'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { useSelector } from 'react-redux'\nimport { useMeasure } from 'react-use'\n\nimport {\n  indicatorColnames,\n  indicatorColnamesKeys,\n} from '../../../utils/dataUtils'\n\n// Using a smaller precompiled version of plotly.js\n// https://github.com/plotly/react-plotly.js/issues/98#issuecomment-689075526\nconst Plot = createPlotlyComponent(Plotly)\n\nconst config = {\n  displayModeBar: false,\n}\n\nconst layout = {\n  plot_bgcolor: 'transparent',\n  paper_bgcolor: 'transparent',\n  showlegend: false,\n  legend: {\n    x: 0,\n    y: 2,\n  },\n  hovermode: false,\n  margin: {\n    l: 200,\n    r: 0,\n    t: 15,\n    b: 15,\n  },\n  xaxis: {\n    // title: 'Val',\n    showticklabels: 'true',\n    zeroline: true,\n    range: [-4, 4.1],\n    mirror: 'ticks',\n    tickmode: 'linear',\n  },\n  yaxis: {\n    // title: 'Indicator',\n    // tickangle: -90,\n    showticklabels: true,\n    tickfont: {\n      size: 11,\n    },\n  },\n  boxgap: 0.1,\n}\n\nfunction getColumnDisplayName(colName) {\n  return `${indicatorColnames[colName]?.habitatLabel} ${indicatorColnames[\n    colName\n  ]?.label?.toLowerCase()}`\n}\n\nfunction getColumnColor(colName) {\n  return indicatorColnames[colName]?.habitatColor\n}\n\nfunction getColumnHabitat(colName) {\n  return indicatorColnames[colName]?.habitat\n}\n\nconst selectedCellMarker = {\n  size: 7,\n  symbol: 'diamond',\n  color: '#ffaaff',\n  line: { color: '#cc00ff', width: 1 },\n}\n\nfunction filterSignificantData({\n  quantileValue,\n  gridItems,\n  columns = indicatorColnamesKeys,\n}) {\n  const residuals = gridItems.map((item) => item.residuals)\n  /*\n  R code\n  dat_signif <- dtemp %>%\n    group_by(Indicator, Cluster) %>%\n    summarize(upr = quantile(Val, 0.5 + (input$quant/2), \n                            na.rm = TRUE),\n              lwr = quantile(Val, 0.5 - input$quant/2, \n                            na.rm = TRUE)) %>%\n    mutate(\n          signif = (sign(lwr) == sign(upr))*sign(upr)\n          \n    )\n\n    left_join(dtemp, dat_signif) %>%\n      filter(signif !=0)\n    \n  })\n*/\n  const indicatorColumnSignificance = (colName) => {\n    const accessor = (item) => item[colName]\n    const upper = quantile(residuals, 0.5 + quantileValue / 2, accessor)\n    const lower = quantile(residuals, 0.5 - quantileValue / 2, accessor)\n\n    // TODO: check this significance test\n    const significanceFactor =\n      Math.sign(lower) === Math.sign(upper) ? Math.sign(upper) : 0\n\n    return significanceFactor\n  }\n\n  const columnSignificance = columns.map(indicatorColumnSignificance)\n\n  const significantIndicatorColumns = columns\n    .map((colName, index) => ({\n      colName,\n      significanceFactor: columnSignificance[index],\n    }))\n    .filter(({ significanceFactor }) => significanceFactor !== 0)\n\n  return { significantIndicatorColumns }\n}\n\nfunction groupColumnsByDimension(columns) {\n  const groupedBy = _.groupBy(columns, ({ colName }) => {\n    const col = indicatorColnames[colName]\n    return col?.dimension\n  })\n  return groupedBy\n}\n\nfunction useTypologyPlotData({\n  width,\n  significantIndicatorColumns,\n  gridItems,\n  gridItem,\n}) {\n  const enabledHabitats = useSelector(\n    (state) => state.globalSettings.enabledHabitats\n  )\n\n  const filteredColumns = significantIndicatorColumns.filter(({ colName }) =>\n    enabledHabitats.includes(getColumnHabitat(colName))\n  )\n  const columnsByDimension = groupColumnsByDimension(filteredColumns)\n  const groupedPlots = _.chain(columnsByDimension)\n    .map((indicatorColumns, dimension) => {\n      const boxplots = indicatorColumns.reverse().map(({ colName }) => {\n        const color = getColumnColor(colName)\n        // Accessing residuals data\n        const x = gridItems.map((item) => item.residuals[colName])\n        const displayName = getColumnDisplayName(colName)\n        const boxplot = {\n          type: 'violin',\n          x,\n          name: displayName,\n          showlegend: false,\n          // whiskerwidth: 0.2,\n          // boxpoints: 'all',\n          marker: { color, size: 3 },\n          line: {\n            width: 1,\n          },\n        }\n        return boxplot\n      })\n\n      const currentGridItemMarkers = indicatorColumns.map(({ colName }) => {\n        const displayName = getColumnDisplayName(colName)\n        const name = `Cell ${displayName}`\n        const y = [displayName]\n        const x = [gridItem.residuals[colName]]\n        const marker = {\n          x,\n          y,\n          name,\n          // text: 'Some really interesting hover info',\n          showlegend: false,\n          marker: selectedCellMarker,\n        }\n        return marker\n      })\n\n      const currentGridItemLegendTrace = {\n        // Dummy trace to create legend item\n        x: [null],\n        y: [null],\n        name: 'Selected Cell',\n        marker: selectedCellMarker,\n      }\n\n      const rowHeight = 40\n      const height = indicatorColumns.length * rowHeight\n\n      const calculatedLayout = {\n        ...layout,\n        width,\n        height,\n      }\n\n      return {\n        data: [\n          ...boxplots,\n          ...currentGridItemMarkers,\n          currentGridItemLegendTrace,\n        ],\n        layout: calculatedLayout,\n        dimension,\n      }\n    })\n    .sortBy('dimension')\n    .value()\n\n  return {\n    groupedPlots,\n  }\n}\n\nexport function TypologyBoxPlot({ gridItems, gridItem, quantileValue = 0.8 }) {\n  const [containerRef, { width }] = useMeasure()\n\n  const { significantIndicatorColumns } = filterSignificantData({\n    quantileValue,\n    gridItems,\n  })\n\n  const { groupedPlots } = useTypologyPlotData({\n    significantIndicatorColumns,\n    width,\n    gridItems,\n    gridItem,\n  })\n\n  return (\n    <div ref={containerRef} style={{ width: '100%' }}>\n      {!groupedPlots.length && (\n        <div className=\"notification is-warning is-light\">\n          No indicators of significance\n        </div>\n      )}\n      {!!groupedPlots.length &&\n        groupedPlots.map(({ data, layout, dimension }, index) => {\n          return (\n            <div key={`groupedPlot${dimension}`} className=\"block\">\n              <h6 className=\"title is-6 mb-0 is-underlined\">{dimension}</h6>\n              <Plot data={data} layout={layout} config={config} />\n            </div>\n          )\n        })}\n    </div>\n  )\n}\n","import { useDispatch, useSelector } from 'react-redux'\n\nimport { SliderInput } from '../../common/SliderInput'\nimport { setTypologyBoxPlotQuantile } from '../../redux/globalSettingsSlice'\nimport { formatCoordinate } from '../../utils/mapUtils'\nimport { TypologyBoxPlot } from './charts/TypologyBoxPlot'\n\nexport function GridItemWidget({\n  selectedGridItemData,\n  gridItems,\n  clusters,\n  gridItemsPerCluster,\n}) {\n  const typologyBoxPlotQuantile = useSelector(\n    (state) => state.globalSettings.typologyBoxPlotQuantile\n  )\n\n  const gridItem = selectedGridItemData?.[0]\n\n  const { TERRITORY1, ID, clusterNumber, color, fillColor, centerCoords } =\n    gridItem\n\n  const cluster = clusters.find(({ n }) => n === clusterNumber)\n\n  return (\n    <div className=\"Widgets--Box--Inner\">\n      <div className=\"content\">\n        <h3>{TERRITORY1}</h3>\n        <h6 className=\"tag\">{formatCoordinate(centerCoords)}</h6>\n\n        <div className=\"field is-grouped is-grouped-multiline\">\n          <div className=\"control\">\n            <div className=\"tags has-addons\">\n              <span className=\"tag\">ID</span>\n              <span className=\"tag is-light has-text-weight-bold\">{ID}</span>\n            </div>\n          </div>\n\n          <div className=\"control\">\n            <div className=\"tags has-addons\">\n              <span className=\"tag\">Typology</span>\n              <span\n                className=\"tag\"\n                style={{\n                  backgroundColor: fillColor,\n                  border: `1px solid ${color}`,\n                  fontWeight: 600,\n                }}\n              >\n                {clusterNumber}\n              </span>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"block\">\n          <TypologyBoxPlotQuantileInput />\n        </div>\n\n        <TypologyBoxPlot\n          cluster={cluster}\n          gridItems={gridItemsPerCluster[clusterNumber]}\n          gridItem={gridItem}\n          quantileValue={typologyBoxPlotQuantile}\n        />\n      </div>\n    </div>\n  )\n}\n\nfunction TypologyBoxPlotQuantileInput() {\n  const dispatch = useDispatch()\n  const typologyBoxPlotQuantile = useSelector(\n    (state) => state.globalSettings.typologyBoxPlotQuantile\n  )\n  return (\n    <fieldset className=\"field\" style={{ maxWidth: 300 }}>\n      <label className=\"label\" style={{ marginBottom: 18 }}>\n        Quantile for Typology Boxplot:{' '}\n        <span className=\"tag\">{typologyBoxPlotQuantile}</span>\n      </label>\n      <div className=\"control\">\n        <SliderInput\n          min={0}\n          max={0.99}\n          step={0.05}\n          value={typologyBoxPlotQuantile}\n          onChange={(value) => {\n            dispatch(setTypologyBoxPlotQuantile(value))\n          }}\n          aria-label=\"Number of Clusters\"\n        />\n      </div>\n    </fieldset>\n  )\n}\n","import './MapLegend.css'\n\nimport { useDispatch, useSelector } from 'react-redux'\n\nimport { SliderInput } from '../../common/SliderInput'\nimport {\n  setNumberOfClusters,\n  toggleEnabledHabitat,\n} from '../../redux/globalSettingsSlice'\n\nexport function MapLegend({ clusters }) {\n  const dispatch = useDispatch()\n  const numberOfClusters = useSelector(\n    (state) => state.globalSettings.numberOfClusters\n  )\n\n  const enabledHabitats = useSelector(\n    (state) => state.globalSettings.enabledHabitats\n  )\n\n  function HabitatCheckbox({ title, name }) {\n    function toggleHabitat(e) {\n      const habitat = e.target.name\n      dispatch(toggleEnabledHabitat(habitat))\n    }\n\n    return (\n      <div className=\"control\">\n        <label className=\"checkbox\">\n          <input\n            type=\"checkbox\"\n            name={name}\n            onChange={toggleHabitat}\n            checked={enabledHabitats.includes(name)}\n          />\n          {title}\n        </label>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"MapLegend\">\n      <fieldset className=\"field\" style={{ maxWidth: 330 }}>\n        <label className=\"label\" style={{ marginBottom: 18 }}>\n          Number of Typologies: <span className=\"tag\">{numberOfClusters}</span>\n        </label>\n        <div className=\"control\">\n          <SliderInput\n            min={2}\n            max={10}\n            step={1}\n            value={numberOfClusters}\n            onChange={(value) => {\n              dispatch(setNumberOfClusters(value))\n            }}\n            aria-label=\"Number of Clusters\"\n          />\n        </div>\n      </fieldset>\n\n      <div className=\"MapLegend--Display block\">\n        {clusters.map((cluster) => {\n          return (\n            <div\n              className=\"MapLegend--ColourStop\"\n              key={`ColourStop-${cluster.n}`}\n            >\n              <div\n                className=\"MapLegend--ColourBox\"\n                style={{\n                  borderColor: cluster.color,\n                  backgroundColor: cluster.fillColor,\n                }}\n              >\n                <span className=\"MapLegend--Value\">{cluster.n}</span>\n              </div>\n            </div>\n          )\n        })}\n      </div>\n\n      <fieldset className=\"field\">\n        <label className=\"label\">Habitats</label>\n        <HabitatCheckbox title=\"Mangroves\" name=\"mg\" />\n        <HabitatCheckbox title=\"Saltmarsh\" name=\"sm\" />\n        <HabitatCheckbox title=\"Seagrass\" name=\"sg\" />\n      </fieldset>\n    </div>\n  )\n}\n","export function IconButton({ Icon, onClick, ...props }) {\n  const handleKeyDown = (e) => {\n    if (e.code === 'Space' || e.code === 'Enter') {\n      onClick(e)\n    }\n  }\n  return (\n    <Icon\n      role=\"button\"\n      onClick={onClick}\n      onKeyDown={handleKeyDown}\n      tabIndex={0}\n      aria-pressed=\"false\"\n      {...props}\n    />\n  )\n}\n","import './Popup.css'\n\nimport { X as CloseIcon } from 'react-feather'\nimport Modal from 'react-modal'\n\nimport { IconButton } from './IconButton'\n\n// Make sure to bind modal to your appElement (http://reactcommunity.org/react-modal/accessibility/)\nModal.setAppElement(`body`)\n\nexport function Popup({ title, modalIsOpen, setModalIsOpen, children }) {\n  function afterOpenModal() {}\n\n  function closeModal() {\n    setModalIsOpen(false)\n  }\n\n  return (\n    <Modal\n      isOpen={modalIsOpen}\n      onAfterOpen={afterOpenModal}\n      onRequestClose={closeModal}\n      className=\"Popup--Modal\"\n      overlayClassName=\"Popup--Overlay\"\n    >\n      <div className=\"Popup--Modal--Inner\">\n        {title && <h3 className=\"Popup--Title\">{title}</h3>}\n        <div className=\"Popup--Content\">{children}</div>\n      </div>\n      <IconButton\n        Icon={CloseIcon}\n        className=\"Popup--CloseButton\"\n        onClick={closeModal}\n      />\n    </Modal>\n  )\n}\n","export default __webpack_public_path__ + \"static/media/fig1.f2937d0d.png\";","import './Menu.css'\n\nimport { Fragment, useState } from 'react'\n\nimport { IconButton } from '../../common/IconButton'\nimport { Popup } from '../../common/Popup'\nimport fig1 from '../../images/fig1.png'\n\nconst MenuPopupContent = () => (\n  <div>\n    <figure style={{ width: '100%', maxWidth: 550 }}>\n      <img src={fig1} alt=\"Figure 1\" width={1488} height={1334} />\n      <figcaption>\n        Figure 1: Flow diagram of the nine key methodological steps used to map\n        and diagnose spatially explicit typologies of coastal wetland ecosystem\n        condition applicable at a global scale.\n      </figcaption>\n    </figure>\n  </div>\n)\n\nconst MenuIcon = (props) => {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"24\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      {...props}\n    >\n      <circle cx=\"12\" cy=\"12\" r=\"11.5\"></circle>\n      <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\"></path>\n      <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line>\n    </svg>\n  )\n}\n\nexport function Menu() {\n  const [menuIsOpen, setMenuIsOpen] = useState(false)\n  const showMenuHelpText = true\n\n  const menuPopupTitle = 'Glowdex App'\n\n  const openMenu = () => {\n    setMenuIsOpen(true)\n  }\n\n  return (\n    <Fragment>\n      <div className=\"Menu--MenuButtonWrap\" data-hashelptext={showMenuHelpText}>\n        <IconButton\n          Icon={MenuIcon}\n          onClick={openMenu}\n          className=\"Menu--MenuButton\"\n          title=\"Open Menu\"\n          tabIndex={1}\n        />\n        <div className=\"Menu--HelpText\">\n          Click on a grid cell to get started\n        </div>\n      </div>\n      <Popup\n        title={menuPopupTitle}\n        modalIsOpen={menuIsOpen}\n        setModalIsOpen={setMenuIsOpen}\n      >\n        <MenuPopupContent />\n      </Popup>\n    </Fragment>\n  )\n}\n","export function WidgetBox({ children, onClose, ...props }) {\n  return (\n    <div className=\"Widgets--Box\" {...props}>\n      {children}\n    </div>\n  )\n}\n","import './Widgets.css'\n\nimport { useSelectedGridItemData } from '../../utils/dataHooks'\nimport { GridItemWidget } from './GridItemWidget'\nimport { MapLegend } from './MapLegend'\nimport { Menu } from './Menu'\nimport { WidgetBox } from './WidgetBox'\n\nexport function Widgets({\n  mapFeatures,\n  gridItems,\n  clusters,\n  isLoading,\n  gridItemsPerCluster,\n}) {\n  const { selectedGridItemData } = useSelectedGridItemData({\n    mapFeatures,\n    gridItems,\n  })\n\n  return (\n    <div className=\"Widgets--Wrap\">\n      <Menu />\n\n      {!isLoading && (\n        <WidgetBox>\n          <MapLegend clusters={clusters} />\n        </WidgetBox>\n      )}\n\n      {!!selectedGridItemData?.length && (\n        <WidgetBox>\n          <GridItemWidget\n            selectedGridItemData={selectedGridItemData}\n            clusters={clusters}\n            gridItemsPerCluster={gridItemsPerCluster}\n            gridItems={gridItems}\n          />\n        </WidgetBox>\n      )}\n    </div>\n  )\n}\n","import ReactSplit, { SplitDirection } from '@devbookhq/splitter'\n\nimport { Map } from '../features/map/Map'\nimport { Widgets } from '../features/widgets/Widgets'\nimport { useMapData } from '../utils/dataHooks'\nimport styles from './App.module.css'\n\nconst initialPanelSizes = [40, 60]\n\nexport function App() {\n  const { mapFeatures, gridItems, clusters, gridItemsPerCluster, isLoading } =\n    useMapData()\n  return (\n    <main className={styles.main}>\n      <ReactSplit\n        direction={SplitDirection.Horizontal}\n        initialSizes={initialPanelSizes}\n        minWidth={300}\n        gutterClassName={styles.ReactSplitGutterHorizontal}\n        draggerClassName={styles.ReactSplitDraggerHorizontal}\n      >\n        <Widgets\n          mapFeatures={mapFeatures}\n          gridItems={gridItems}\n          clusters={clusters}\n          isLoading={isLoading}\n          gridItemsPerCluster={gridItemsPerCluster}\n        />\n        <Map\n          mapFeatures={mapFeatures}\n          gridItems={gridItems}\n          clusters={clusters}\n          isLoading={isLoading}\n        />\n      </ReactSplit>\n    </main>\n  )\n}\n","import {\n  FLUSH,\n  PAUSE,\n  PERSIST,\n  PURGE,\n  REGISTER,\n  REHYDRATE,\n  persistReducer,\n  persistStore,\n} from 'redux-persist'\nimport storage from 'redux-persist/lib/storage'\n\nimport {\n  combineReducers,\n  configureStore,\n  getDefaultMiddleware,\n} from '@reduxjs/toolkit'\n\nimport globalSettingsSlice from './globalSettingsSlice'\nimport gridItemsSlice from './gridItemsSlice'\n\nconst createPersistedReducer = ({ key, reducer, config = {} }) => {\n  const persistConfig = {\n    key,\n    storage,\n    ...config,\n  }\n\n  const persistedReducer = persistReducer(persistConfig, reducer)\n  return persistedReducer\n}\n\nconst rootReducer = combineReducers({\n  globalSettings: createPersistedReducer({\n    reducer: globalSettingsSlice,\n    key: 'globalSettings',\n  }),\n  gridItems: gridItemsSlice,\n})\n\nexport const store = configureStore({\n  reducer: rootReducer,\n  middleware: getDefaultMiddleware({\n    serializableCheck: {\n      ignoredActions: [FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER],\n    },\n  }),\n})\nexport const persistor = persistStore(store)\n","import 'modern-normalize/modern-normalize.css'\nimport 'bulma/css/bulma.css'\n\nimport './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Provider } from 'react-redux'\nimport { PersistGate } from 'redux-persist/integration/react'\n\nimport { App } from './app/App'\nimport { persistor, store } from './redux/store'\n\nconst appElementID = 'root'\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <PersistGate loading={null} persistor={persistor}>\n        <App />\n      </PersistGate>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(appElementID)\n)\n"],"sourceRoot":""}